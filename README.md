# Beancount-Trans

ğŸŒŸBeancount-Trans - åŸºäºè¯­ä¹‰åˆ†æå’Œè§„åˆ™å¼•æ“çš„è‡ªåŠ¨åŒ– Beancount è´¦å•ç”Ÿæˆå·¥å…·

## ğŸš€ æ ¸å¿ƒä»·å€¼

ç»è¿‡é•¿æœŸå¯¹ Beancount çš„ä½¿ç”¨å’Œæµ‹è¯•ï¼Œæˆ‘å‘ç°åœ¨æ—¥å¸¸è®°è´¦ä¸­æœ€çƒ¦æ¼çš„æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š

1. ç”±äº**è®°å½•æ•°é‡å¤ªå¤š**ï¼Œè‹¥æ¯ä¸ªè®°å½•éƒ½ä»¥å•ç‹¬æ¡ç›®è®°å½•åˆ™éœ€è¦è€—è´¹å¤§é‡æ—¶é—´ï¼Œè‹¥ä»¥å¤©ä¸ºæ¡ç›®è¿›è¡Œè®°è´¦ï¼Œåˆä¼šå¯¼è‡´æ¡ç›®çš„**é¢—ç²’åº¦å¤ªå¤§**ï¼›
2. æˆ‘æ˜¯ä»¥å‘¨ä¸ºé¢‘ç‡è¿›è¡Œè®°è´¦æ–­è¨€çš„ï¼Œå¯¹äºé•¿æœŸè®°è´¦æ¥è¯´è¿™ä¸ª**é¢‘ç‡æœªå…å¤ªé¢‘ç¹**ï¼›
3. **æ”¯å‡ºè´¦æˆ·æ²¡æœ‰å½¢æˆç³»ç»Ÿçš„è§„åˆ’**ï¼Œå¯¼è‡´è®°å½•æ¡ç›®æ—¶æ€»æ˜¯è¦çº ç»“é€‰ç”¨å“ªä¸ªæ”¯å‡ºè´¦æˆ·ï¼Œä¸”è®°å½•åä¹Ÿæ— æ³•é€šè¿‡ FAVA çš„è¯•ç®—è¡¨äº†è§£è‡ªå·±çš„å„ç±»æ”¯å‡ºæƒ…å†µï¼›

![Beancount-Trans é¦–é¡µ](https://daihaorui.oss-cn-hangzhou.aliyuncs.com/djangoblog/202310101642806.png)
[åœ¨çº¿ä½“éªŒ](https://trans.dhr2333.cn/) | [æœ¬åœ°éƒ¨ç½²](#ğŸ³%20å¿«é€Ÿå¼€å§‹ï¼ˆæœ¬åœ°å®¹å™¨ç¯å¢ƒéƒ¨ç½²ï¼‰) | [æ¡ˆä¾‹è´¦æœ¬](https://fava.pythonanywhere.com/example-beancount-file/income_statement/)

## âš¡ å¿«é€Ÿå¼€å§‹

**ä¸Šä¼ è´¦å•ï¼Œç³»ç»Ÿä¼šæ ¹æ®å®šä¹‰å¥½çš„å•†æˆ·å’Œè´¦æˆ·è‡ªåŠ¨æ ¼å¼åŒ–è¾“å‡ºä¸º beancount èƒ½è¯†åˆ«çš„æ–‡æœ¬**ã€‚å½“å‰æ”¯æŒè‡ªåŠ¨æ›´æ–°è‡³ [Beancount-Trans-Assets](https://github.com/dhr2333/Beancount-Trans-Assets) é¡¹ç›®ï¼Œä»…æ”¯æŒæœ¬åœ°éƒ¨ç½²ç”¨æˆ·å¯ç”¨ã€‚

1. æ ¹æ® [è´¦å•å¯¼å‡ºåŠæŸ¥çœ‹æ–¹æ³•](https://www.dhr2333.cn/article/2024/4/27/77.html) ä»å¯¹åº”å¹³å°ä¸­è·å–è´¦å•
2. åœ¨ [é¦–é¡µ](https://trans.dhr2333.cn/trans) ä¸Šä¼  csv æˆ– pdf æ–‡ä»¶å®Œæˆè§£æï¼ˆæ— ç™»å½•ç”¨æˆ·é»˜è®¤ä½¿ç”¨ admin çš„é€šç”¨æ˜ å°„æ¨¡æ¿ï¼‰
3. å¤åˆ¶è§£æåçš„æ–‡æœ¬è‡³ *è‡ªå·±è´¦æœ¬* æˆ– Beancount-Trans-Assets é¡¹ç›®ï¼ˆæä¾›åŸºç¡€çš„ç›®å½•ç»“æ„ï¼‰å¯¹åº”çš„å¹´æœˆç›®å½•ä¸­
4. ä¿®æ”¹æ–‡æœ¬ä¸­çš„ Expense:Other å’Œ Assets:Other çš„æ¡ç›®ï¼ˆæ²¡æœ‰å¯¹åº”çš„æ˜ å°„æ¡ç›®ï¼‰
5. åœ¨ Beancount-Trans-Assets é¡¹ç›®ä¸­ä½¿ç”¨ `fava main.bean` è¿è¡Œç¨‹åºï¼Œé€šè¿‡ http://127.0.0.1:5000 è®¿é—®
6. æ ¹æ® fava æç¤ºä¿®æ”¹é”™è¯¯æ¡ç›®

![](https://daihaorui.oss-cn-hangzhou.aliyuncs.com/djangoblog/202403121150123.png)

![](https://daihaorui.oss-cn-hangzhou.aliyuncs.com/djangoblog/202403121150282.png)

## ä½¿ç”¨è¯´æ˜

è¯¥é¡¹ç›®é»˜è®¤è¯»è€…æœ‰ beancount çš„ä½¿ç”¨ç»éªŒã€‚åœ¨ä½¿ç”¨ Beancount-Trans è¿‡ç¨‹ä¸­ï¼Œæœ‰ä»¥ä¸‹å‡ ç‚¹éœ€è¦æ³¨æ„

### ç¡®å®šæ˜ å°„è´¦æˆ·

```mermaid
graph TD
    A[å¼€å§‹] --> B{äº¤æ˜“ç±»å‹}
    B -->|æ”¯å‡º| C[åŒ¹é…å…³é”®å­—+ä¼˜å…ˆçº§è®¡ç®—]
    B -->|æ”¶å…¥/ä¸è®¡æ”¶æ”¯| D[ç›´æ¥åˆ†ç±»]
    C --> E{å­˜åœ¨å†²çª?}
    E -->|æ˜¯| F[AIè¯­ä¹‰å†³ç­–]
    E -->|å¦| G[ç¡®å®šåˆ†ç±»]
    F --> G
    G --> H[ç»“æŸ]
    D --> H

    classDef focus fill:#f9f,stroke:#333;
    class E,F focus
```

#### è§£æä¼˜å…ˆçº§

å½“å¤šä¸ªå•†å®¶åç§°ç›¸ä¼¼æ—¶ï¼ˆå¦‚ã€Œåä¸ºã€ã€Œåä¸ºç»ˆç«¯ã€ã€Œåä¸ºè½¯ä»¶ã€ï¼‰ï¼Œç³»ç»Ÿéœ€è¦çŸ¥é“å“ªä¸ªåˆ†ç±»æ›´ç²¾å‡†ã€‚æˆ‘ä»¬é€šè¿‡ã€Œåˆ†ç±»å±‚çº§æ·±åº¦ã€å’Œã€Œå•†å®¶ä¿¡æ¯ã€ä¸¤ä¸ªç»´åº¦æ™ºèƒ½åˆ¤æ–­ä¼˜å…ˆçº§ã€‚

| åˆ†ç±»ç¤ºä¾‹                    | å±‚çº§æ·±åº¦            | åŠ åˆ†é¡¹       | æ€»ä¼˜å…ˆçº§ | åŒ¹é…ç»“æœ       |
| ----------------------- | --------------- | --------- | ---- | ---------- |
| åä¸º â†’ Shopping           | 2 å±‚ (2Ã—100=200) | æ— å•†å®¶ä¿¡æ¯     | 200  | ğŸŸ¡ åŸºç¡€åŒ¹é…    |
| åä¸ºè½¯ä»¶ â†’ Culture          | 2 å±‚ (2Ã—100=200) | æœ‰å•†å®¶ä¿¡æ¯ +50 | 250  | ğŸŸ¢ ä¼˜å…ˆåŒ¹é…    |
| åä¸ºç»ˆç«¯ â†’ Shopping:Digital | 3 å±‚ (3Ã—100=300) | æœ‰å•†å®¶ä¿¡æ¯ +50 | 350  | ğŸŸ¢ æœ€é«˜ä¼˜å…ˆçº§åŒ¹é… |

1. å±‚çº§è¶Šæ·±è¶Šç²¾å‡†ï¼šæ¯å¤šä¸€çº§åˆ†ç±»ï¼ˆç”¨å†’å·åˆ†éš”ï¼‰ï¼Œä¼˜å…ˆçº§è‡ªåŠ¨ +100
2. å•†å®¶ä¿¡æ¯åŠ åˆ†ï¼šå¡«å†™å•†å®¶è¯¦ç»†ä¿¡æ¯ï¼ˆå¦‚ã€Œåä¸ºæ——èˆ°åº—ã€ï¼‰ï¼Œä¼˜å…ˆçº§é¢å¤– +50
3. å½“å‡ºç°å¤šä¸ªæ¡ç›®è§£æä¼˜å…ˆçº§ç›¸åŒæ—¶ï¼špayee å­—æ®µä¼šä¿ç•™åŸå§‹å•†å®¶

#### ğŸ¤– AI è¾…åŠ©å†³ç­–

å½“å‡ºç°å¤šä¸ªæ¡ç›®è§£æä¼˜å…ˆçº§ç›¸åŒæ—¶ï¼š

```text
2024-01-01 08:00:00,ä¿é™©,å›½æ³°**å¸,fin***@cathay-ins.com.cn,ä¿é™©-ä¹°å®¶ç‰ˆè¿è´¹é™©-EGGKAæœ¨è€³è¾¹ä¸€ä½“ç»’æ‰“åº•è¡«å¥³å†…æ­ç§‹å†¬2022æ–°æ¬¾åŠé«˜é¢†åŠ ç»’é’ˆç»‡ä¸Šè¡£ç­‰,æ”¯å‡º,7.88,ä¸­ä¿¡é“¶è¡Œä¿¡ç”¨å¡(5718),äº¤æ˜“æˆåŠŸ,2023010522001199861407503809	,T1100P1790123557322669684	,,
å€™é€‰å…³é”®å­—: ["ä¿é™©", "è¿è´¹", "æ‰“åº•è¡«", "ä¸Šè¡£"]

â€¢ ä¿é™© â†’ Expenses:Finance:Insurance (ä¼˜å…ˆçº§200)
â€¢ æ‰“åº•è¡« â†’ Expenses:Shopping:Clothing (ä¼˜å…ˆçº§200)
â€¢ ä¸Šè¡£ â†’ Expenses:Shopping:Clothing (ä¼˜å…ˆçº§200)

# AIå†³ç­–è¿‡ç¨‹ï¼š
1. spaCyè®¡ç®—ç›¸ä¼¼åº¦: 
   - "ä¿é™©" â†’ 0.72
   - "æ‰“åº•è¡«" â†’ 0.64
   - "ä¸Šè¡£" â†’ 0.68
1. é€‰æ‹©æœ€é«˜å€¼ â†’ "ä¿é™©"
```

#### ä¸‰é¤åˆ¤æ–­

æœåŠ¡å¯¹ä¸‰é¤çš„åˆ¤æ–­æœ‰ä¸¤ç§å½¢å¼ï¼Œä¸€ç§æ˜¯æ ¹æ® Expense ä¸­çš„æ”¯å‡ºæ˜ å°„æ¥å†³å®šæœ€ç»ˆçš„æ¡ç›®ï¼Œä¾‹å¦‚è´¦å•ä¸­å«æœ‰ " æ—©é¤ " çš„å¤‡æ³¨ä¼šè¢«åŒ¹é…åˆ° "Expenses:Food:Breakfast"ã€‚

è¿˜æœ‰ä¸€ç§æ˜¯åç«¯çš„ç¡¬ç¼–ç ï¼Œç³»ç»Ÿåœ¨æ ¹æ®æ”¯å‡ºæ˜ å°„è§£æå®Œæˆåå¾—åˆ°çš„æ¡ç›®ä¸º "Expenses:Food" æ—¶ï¼Œä¼šæ ¹æ®è´¦å•æ—¶é—´å¯¹æ¡ç›®è¿›è¡Œè°ƒæ•´ï¼Œä¾‹å¦‚å‘ç”Ÿåœ¨ 06:00 åˆ° 10:00 ä¹‹é—´çš„ "Expenses:Food" æ¡ç›®ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ä¿®æ”¹ä¸º "Expenses:Food:BreakFast"ã€‚

æ—¶æ®µé…ç½®ï¼š
- ğŸ³ æ—©é¤ï¼š06:00-10:00
- ğŸ± åˆé¤ï¼š10:00-14:00
- ğŸ² æ™šé¤ï¼š16:00-20:00

å½“æ”¯å‡ºæ˜ å°„ä¸ä¸‰é¤æ—¶é—´å†²çªæ—¶ï¼Œä¾‹å¦‚åœ¨ `2023-11-26 10:49:54,æ‰«äºŒç»´ç ä»˜æ¬¾,ç‘å®‰å¸‚æš–çˆ¸å‰¯é£Ÿå“åº—,"æ”¶æ¬¾æ–¹å¤‡æ³¨:äºŒç»´ç æ”¶æ¬¾ä»˜æ¬¾æ–¹ç•™è¨€:é¥®æ–™",æ”¯å‡º,Â¥3.00,é›¶é’±é€š,å·²è½¬è´¦,100004990123112600060327753584678844	,10000499012023112601373972597516	,"/"` æ¡ç›®ä¸­

åŒ…å« " é¥®æ–™ " å’Œ " é£Ÿå“ " ä¸¤ä¸ªå…³é”®å­—ï¼Œå…¶ä¸­ " é¥®æ–™ " çš„ Expense ä¸º "Expenses:Food:DrinkFruit"ï¼Œ" é£Ÿå“ " çš„ Expense ä¸º "Expenses:Food"ã€‚è™½ç„¶æ ¹æ®ä¸‰é¤åˆ¤æ–­æ—¶é—´ä¸ºæ—©é¤ "Expenses:Food:Breakfast" ä¸ "Expenses:Food:DrinkFruit" ä¼˜å…ˆçº§ä¸€è‡´ï¼Œä½†å®é™…æƒ…å†µå½’ç±»äºæ—©é¤å¹¶ä¸åˆé€‚ã€‚

æ‰€ä»¥å…³é”®å­—ä¸ä¸‰é¤çš„åˆ¤æ–­è§„åˆ™ä¸ºï¼šå…ˆåˆ¤æ–­å…³é”®å­—ä¼˜å…ˆçº§ï¼Œå†åˆ¤æ–­ä¸‰é¤æ—¶é—´ã€‚

### é»˜è®¤å¿½ç•¥

é»˜è®¤ä¼šå¯¹ä½™é¢å®è´¦æˆ·çš„æ”¶ç›Šè¿›è¡Œå¿½ç•¥ï¼Œè¯·åœ¨ä¸‹ä¸ªæœˆ balance æ—¶ä»¥ "Income:Investment:Interest" åˆ©æ¯è®¡å…¥ã€‚

é»˜è®¤ä¼šå¯¹å¾®ä¿¡æ”¯ä»˜çŠ¶æ€ä¸º " å·²å…¨é¢é€€æ¬¾ "ã€ " å¯¹æ–¹å·²é€€è¿˜ " æˆ–ä»¥ " å·²é€€æ¬¾ " å¼€å¤´çš„æ¡ç›®è¿›è¡Œå¿½ç•¥ã€‚

é»˜è®¤ä¼šå¯¹æ”¯ä»˜å®æ”¯ä»˜çŠ¶æ€ä¸º " é€€æ¬¾æˆåŠŸ "ã€" äº¤æ˜“å…³é—­ "ã€" è§£å†»æˆåŠŸ "ã€" ä¿¡ç”¨æœåŠ¡ä½¿ç”¨æˆåŠŸ "ã€" å·²å…³é—­ "ã€" è¿˜æ¬¾å¤±è´¥ "ã€" ç­‰å¾…ä»˜æ¬¾ " ã€" èŠéº»å…æŠ¼ä¸‹å•æˆåŠŸ " çš„æ¡ç›®è¿›è¡Œå¿½ç•¥ã€‚

é€‰ä¸­ " ç”Ÿæˆ balance å¯¹è´¦ä¿¡æ¯ " æ—¶ï¼Œé»˜è®¤å¿½ç•¥åŒä¸€å¤©éæœ€æ™šçš„è®°å½•ã€‚

### æ‰‹åŠ¨å¤„ç†

æœ€ç»ˆè§£æç»“æœä¸º "Expenses:Other"ã€"Income:Other"ã€"Assets:Other" æ—¶ï¼Œè¯´æ˜æ— æ³•æ­£ç¡®è§£æï¼Œè¯·æ‰‹åŠ¨å¤„ç†æˆ–å¢åŠ æ˜ å°„åå†æ¬¡è§£æã€‚

å½“æŸä¸ªé“¶è¡Œå«æœ‰å¤šå¼ å‚¨è“„å¡æ—¶ï¼Œè§£æç»“æœå¯èƒ½é”™è¯¯éœ€æ‰‹åŠ¨å¤„ç†ã€‚

ç”±äºå„è´¦å•çš„å­—æ®µæ˜¯ä»¥ *é€—å·* ä½œä¸ºåˆ†éš”ï¼Œæ‰€ä»¥æ— æ³•è§£æå•†å®¶åç§°åŒ…å« `,` çš„æ¡ç›®ã€‚

### è‡ªåŠ¨å†™å…¥ Beancount-Trans-Assets

å½“é€‰ä¸­ " è‡ªåŠ¨å†™å…¥ Beancount-Trans-Assets" åï¼Œç³»ç»Ÿä¼šåœ¨è§£æå®Œæˆåæ£€æŸ¥åŒçº§ç›®å½•ä¸‹ Beancount-Trans-Assets æ˜¯å¦æœ‰å¯¹åº”æœ¬å¹´çš„å¹´åº¦è´¦æœ¬ï¼Œä¾‹å¦‚ `2023`ã€‚å¦‚æœå­˜åœ¨ï¼Œç³»ç»Ÿä¼šå°†æ•°æ®æ­£å¸¸å†™å…¥è¯¥è´¦æœ¬ï¼›å¦‚æœä¸å­˜åœ¨ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºå¹´åº¦è´¦æœ¬ï¼Œå¹¶å°†è§£æåçš„æ–‡æœ¬å†™å…¥å…¶ä¸­ã€‚

æœ¬åœ°ç”¨æˆ·é€šè¿‡ " æœ¬åœ°è´¦æœ¬ " æŸ¥çœ‹ã€‚

å¹³å°ç”¨æˆ·å¯é€šè¿‡è¯¥åŠŸèƒ½å°†é”™è¯¯æ¡ç›®è¾“å‡ºè‡³ " æ¡ˆä¾‹è´¦æœ¬ "ï¼Œä½œè€…ä¼šæ ¹æ® " æ¡ˆä¾‹è´¦æœ¬ " ä¸­çš„æŠ¥é”™ä¿®æ”¹è´¦å•è§£æä»£ç ä»¥æ±‚ä¿è¯è§£æåŠŸèƒ½æ­£ç¡®ã€‚

## ğŸ³ å¿«é€Ÿå¼€å§‹ï¼ˆæœ¬åœ°å®¹å™¨ç¯å¢ƒéƒ¨ç½²ï¼‰

ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨ï¼Œä½œè€…æä¾›æœ¬åœ° docker compose çš„éƒ¨ç½²æ–¹å¼ã€‚**æ¨èä»¥è¯¥æ–¹å¼éƒ¨ç½²ï¼Œé›†æˆäº† fava å±•ç¤ºã€è‡ªåŠ¨è®°å½•ã€OwnTracks è½¨è¿¹è®°å½•ç­‰å¤šé¡¹è‡ªåŠ¨åŒ–åŠŸèƒ½**ã€‚

è‹¥æ—  Docker ç¯å¢ƒï¼Œå¯å‚è€ƒ [æœ¬åœ°ç¯å¢ƒéƒ¨ç½²](#Beancount-Trans-Backend) æ–‡æ¡£ã€‚

### é¡¹ç›®åˆå§‹åŒ–

```shell
git clone https://github.com/dhr2333/Beancount-Trans.git
cd Beancount-Trans; git submodule update --init  # åˆå§‹åŒ–æ‰€æœ‰å­æ¨¡å—
# git submodule foreach git switch main  # æ‰€æœ‰å­æ¨¡å—åˆ‡æ¢åˆ°mainåˆ†æ”¯
# git submodule foreach git pull origin main  # è‹¥æœ‰éœ€è¦åˆ™å°†æ‰€æœ‰å­æ¨¡å—æ‹‰å–mainåˆ†æ”¯ä»£ç 
```

### é¦–æ¬¡è¿è¡Œ

é¦–æ¬¡è¿è¡Œä¼šè‡ªåŠ¨åˆ›å»ºåä¸º `mysql-data` å’Œ `redis-data` çš„å­˜å‚¨å·ã€‚

æ‰€æœ‰å®¹å™¨ç«¯å£å¯è‡ªè¡ŒæŒ‡å®šã€‚

åœ¨ Benacount-Trans ä¸»ç›®å½•ä¸‹è¿è¡Œ

```shell
$ docker compose up  # å¢åŠ  -d å‚æ•°å¯å®ç°åå°è¿è¡Œ
```

æˆ– ç¼–è¯‘åè¿è¡Œ

```shell
services:
  beancount-trans-frontend:
    # image: dhr2333/beancount-trans-frontend:latest
    build:
      context: ./Beancount-Trans-Frontend
      dockerfile: Dockerfile
      args:
        - "--no-cache"
$ docker compose build  # ç¼–è¯‘
$ docker compose up
```

![](https://daihaorui.oss-cn-hangzhou.aliyuncs.com/djangoblog/202403120934590.png)

![](https://daihaorui.oss-cn-hangzhou.aliyuncs.com/djangoblog/202403120934209.png)

### è®¿é—®

é€šè¿‡ http://localhost:38001/trans è¿›è¡Œè§£æï¼ŒåŒæ—¶å¯ä»¥é€šè¿‡ " æˆ‘çš„è´¦æœ¬ " ç›´æ¥è®¿é—®å®Œæ•´è´¦æœ¬ä¿¡æ¯ã€‚

![Pasted image 20231210165239](https://daihaorui.oss-cn-hangzhou.aliyuncs.com/djangoblog/202312101703363.png)

### ğŸ“Š æŒä¹…åŒ–å­˜å‚¨

MySQL é»˜è®¤ä½¿ç”¨åˆå§‹åŒ–æ•°æ®ï¼Œå¹¶ä¸åšæŒä¹…åŒ–å­˜å‚¨ã€‚è‹¥éœ€è¦æŒä¹…åŒ–å­˜å‚¨éœ€è¦æ”¾å¼€ä»¥ä¸‹æ³¨é‡Šï¼š

```yaml
beancount-trans-mysql:
  volumes:
    - mysql:/var/lib/mysql  # è‹¥éœ€è¦æŒä¹…å­˜å‚¨å–æ¶ˆè¯¥æ³¨é‡Šå’Œvolumesä¸­çš„æ³¨é‡Š
volumes:
  mysql:
    external: true  # è‹¥å·²åˆ›å»ºå¤–éƒ¨å­˜å‚¨å·ï¼Œåˆ™å–æ¶ˆè¯¥æ³¨é‡Š(å¤šæ¬¡docker compose upå¯èƒ½ä¼šå¯¼è‡´å­˜å‚¨å·é‡å¤åˆ›å»ºå¯¼è‡´å¯åŠ¨å¤±è´¥)
    name: mysql-data
  redis:
    external: true  # è‹¥å·²åˆ›å»ºå¤–éƒ¨å­˜å‚¨å·ï¼Œåˆ™å–æ¶ˆè¯¥æ³¨é‡Š
    name: redis-data
```

# Beancount-Trans-Assets

[Beancount-Trans-Assets](https://github.com/dhr2333/Beancount-Trans-Assets) é¡¹ç›®æä¾› **Beancount è´¦æœ¬ç»„ç»‡ç»“æ„**ï¼Œæ‰€æœ‰è®°è´¦æ¡ç›®ä»¥æœˆè¿›è¡Œç»Ÿè®¡ï¼Œä»¥å¹´è¿›è¡Œå­˜æ¡£ã€‚

è´¦æœ¬ç»“æ„è¯´æ˜å¯å‚è€ƒ [Beancount_05_é¡¹ç›®ç®¡ç†](https://www.dhr2333.cn/article/2022/9/10/55.html)ã€‚

GitHub ç§æœ‰é¡¹ç›®åˆ›å»ºæˆåŠŸåï¼Œå¯å°†ä»£ç ä¸Šä¼ è‡³ç§æœ‰ä»“åº“

```shell
git clone https://github.com/dhr2333/Beancount-Trans-Assets.git
cd Beancount-Trans-Assets
# ä¿®æ”¹å
git add .
git commit -m "æäº¤è®°å½•"
git remote add origin [ä½ çš„é¡¹ç›®é“¾æ¥]
git branch -M main
git push -u origin main
```

# Beancount-Trans-Backend

Beancount-Trans é¡¹ç›®é›†ä¸­çš„åç«¯é¡¹ç›®ï¼Œä¸»è¦å®ç°è´¦å•æ ¼å¼çš„è½¬æ¢åŠŸèƒ½åŠæä¾›å¯¹å¤–æ¥å£ã€‚

## å®‰è£…

```shell
$ cd Beancount-Trans-Backend
$ pipenv install  #  å®‰è£…è™šæ‹Ÿç¯å¢ƒ
$ pipenv shell  # ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ
$ apt-get install -y mysql libmysqlclient mysql-clients  # requirements.txtä¸­çš„mysqlclientåŒ…ä¾èµ–äºmysql,æ‰€ä»¥éœ€æ‰‹åŠ¨ä¸‹è½½
$ pip install -r requirements.txt  # å®‰è£…æ‰€éœ€ä¾èµ–
```

## é…ç½®

ä¿®æ”¹ `mydemo/setting.py` ä¿®æ”¹æ•°æ®åº“é…ç½®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': os.environ.get('TRANS_MYSQL_DATABASE') or 'beancount-trans',
        'USER': os.environ.get('TRANS_MYSQL_USER') or 'root',
        'PASSWORD': os.environ.get('TRANS_MYSQL_PASSWORD') or 'root',
        'HOST': os.environ.get('TRANS_MYSQL_HOST') or '127.0.0.1',
        'PORT': os.environ.get('TRANS_MYSQL_PORT') or '3306',
        'TIME_ZONE': 'Asia/Shanghai',
    }
}
```

ä¿®æ”¹ `manage.py` é…ç½®æ–‡ä»¶ä½¿ç”¨ *æœ¬åœ°å¼€å‘ç¯å¢ƒ* `mydemo.settings`ï¼š

```python
def main():  
    os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'mydemo.settings')  # æœ¬åœ°å¼€å‘ç¯å¢ƒ
    try:  
        from django.core.management import execute_from_command_line  
    except ImportError as exc:  
        raise ImportError(  
            "Couldn't import Django. Are you sure it's installed and "  
            "available on your PYTHONPATH environment variable? Did you "            "forget to activate a virtual environment?"        ) from exc  
    execute_from_command_line(sys.argv)  
  
  
if __name__ == '__main__':  
    main()
```

## åˆ›å»ºæ•°æ®åº“

MySQL æ•°æ®åº“ä¸­æ‰§è¡Œ:

```sql
CREATE DATABASE `beancount-trans`
```

ç„¶åç»ˆç«¯ä¸‹æ‰§è¡Œ:

```shell
python manage.py makemigrations
python manage.py migrate
```

å¯¼å…¥æä¾›çš„ SQL æ¨¡æ¿ï¼Œå¹¶æ ¹æ®è‡ªå·±çš„å®é™…è´¦æˆ·è¿›è¡Œè°ƒæ•´ï¼š

```shell
mysql -h127.0.0.1 -uroot -proot  beancount-trans < fixtures/20240507-Develop.sql  # å½“å‰æ¨¡æ¿å«æœ‰å¼ºçƒˆçš„ä¸ªäººé£æ ¼ï¼Œå»ºè®®æ ¹æ®è‡ªå·±æƒ…å†µä¿®æ”¹
```

## å¼€å§‹è¿è¡Œ

æ‰§è¡Œï¼š `python manage.py runserver 0:8002`

æµè§ˆå™¨æ‰“å¼€ http://127.0.0.1:8002/translate/trans å°±å¯ä»¥å®Œæˆç®€å•çš„è´¦å•è½¬æ¢ã€‚

# Beancount-Trans-Frontend

ä¿®æ”¹ `.env` é…ç½®æ–‡ä»¶ä½¿ç”¨ *æœ¬åœ°å¼€å‘ç¯å¢ƒ* ï¼š

![](https://daihaorui.oss-cn-hangzhou.aliyuncs.com/djangoblog/202403171820731.png)

è¿è¡Œå‰ç«¯ç¨‹åºï¼š

```shell
$ npm install 
$ npm run dev  # å¯åŠ¨ç¨‹åº
```

æµè§ˆå™¨æ‰“å¼€ http://localhost:5173/ ï¼Œéœ€è¦ Beancount-Trans-Backend åŠæ•°æ®åº“æœåŠ¡æ­£å¸¸è¿è¡Œæ‰èƒ½å®ç°è§£æåŠŸèƒ½ã€‚

# è´¡çŒ® & æèµ 

å¦‚æœä½ å¸Œæœ›å¯¹ Beancount-Trans-Backend åšå‡ºè´¡çŒ®ï¼Œè¯·é˜…è¯»æˆ‘ä»¬çš„ [è´¡çŒ®æŒ‡å—](https://github.com/dhr2333/Beancount-Trans-Backend?tab=readme-ov-file#%E8%B4%A1%E7%8C%AE%E6%8C%87%E5%8D%97)ã€‚

å…³äº Beancount-Trans åŠå­é¡¹ç›®æœ‰ä»»ä½•é¡¹ç›®åŠä½¿ç”¨ä¸Šçš„é—®é¢˜ï¼Œå»ºè®®æ issueã€‚

æèµ æ”¶å…¥å°†å…¨éƒ¨ç”¨äºæé«˜ [ç½‘ç«™](https://trans.dhr2333.cn/) è§£æé€Ÿåº¦ã€‚

## å¾®ä¿¡ & æ”¯ä»˜å®

å¾®ä¿¡æ”¯æŒæ ‡ç­¾è§£æï¼Œå¤‡æ³¨å¯æ·»åŠ åç¼€ `#TEST`

æ”¯ä»˜å®æ”¯æŒä¿¡ç”¨å¡åŠèŠ±å‘—æ”¯ä»˜

<div>
<img src="https://daihaorui.oss-cn-hangzhou.aliyuncs.com/djangoblog/202403311658448.png" width="150" height="150" />  
<img src="https://daihaorui.oss-cn-hangzhou.aliyuncs.com/djangoblog/202405301410904.png" width="150" height="150" />  
</div>
